<html>
<head>
<title>Geospatial PDF</title>
</head>

<body bgcolor="#ffffff">

<h1>Geospatial PDF</h1>

(Available for GDAL &gt;= 1.8.0)
<p>
GDAL supports reading Geospatial PDF documents, by extracting georeferencing information and rasterizing the data.
Non-geospatial PDF documents will also be recognized by the driver.
<p>
Starting with GDAL &gt;= 2.0.0, PDF documents can be created from other GDAL raster datasets.
<p>
GDAL must be compiled with libpoppler support (GPL-licensed), and libpoppler itself must have been configured with
--enable-xpdf-headers so that the xpdf C++ headers are available. Note: the poppler C++ API isn't
stable, so the driver compilation may fail with too old or too recent poppler versions.
Successfully tested versions are poppler &gt;= 0.12.X and &lt;= 0.18.0.
<p>
Starting with GDAL 1.9.0, as an alternative, the PDF driver can be compiled against libpodofo (LGPL-licensed)
to avoid the libpoppler dependency. This is sufficient to get the georeferencing information. However, for
getting the imagery, the pdftoppm utility that comes with the poppler distribution must be available in the system PATH.
A temporary file will be generated in a directory determined by the following configuration options : CPL_TMPDIR,
TMPDIR or TEMP (in that order). If none are defined, the current directory will be used.
Successfully tested versions are libpodofo 0.8.4 and 0.9.1.
<p>
The driver supports reading georeferencing encoded in either of the 2 current existing ways : according to the OGC
encoding best practice, or according to the Adobe Supplement to ISO 32000.
<p>
Multipage documents are exposed as subdatasets, one subdataset par page of the document.
<p>
The neatline (for OGC best practice) or the bounding box (Adobe style) will be reported as a NEATLINE metadata item,
so that it can be later used as a cutline for the warping algorithm.
<p>
Starting with GDAL 1.9.0, XMP metadata can be extracted from the file, and will be
stored as XML raw content in the xml:XMP metadata domain.
<p>

<h2>Configuration options</h2>

<ul>
<li><i>GDAL_PDF_DPI</i> : To control the dimensions of the raster by specifying the DPI of the
rasterization with the Its default value is 150. Starting with GDAL 2.0, the driver
will make some effort to guess the DPI value either from a specific metadata item contained in some PDF files, or
from the raster images inside the PDF (in simple cases).</li>
<p>
Starting with GDAL &gt;= 2.0.0 and when GDAL is compiled against libpoppler, the following options are also
available :

<li><i>GDAL_PDF_RENDERING_OPTIONS</i> : a combination of VECTOR, BITMAP and TEXT separated
by comma, to select whether vector, bitmap or text features should be rendered. If the option is not
specified, all features are rendered.</li>
<li><i>GDAL_PDF_BANDS</i> = 3 or 4 : whether the PDF should be rendered as a RGB (3) or RGBA (4) image.
Defaults to 3.</li>
<li><i>GDAL_PDF_LAYERS</i> = list of layers (comma separated) to turn ON (or "ALL" to turn all layers ON).
The layer names can be obtained by querying the LAYERS metadata domain. When this option is specified,
layers not explicitely listed will be turned off.</li>
<li><i>GDAL_PDF_LAYERS_OFF</i> = list of layers (comma separated) to turn OFF. The layer names can be obtained by
querying the LAYERS metadata domain. When this option is specified, layers not explicitely listed will be turned
off.</li>
</ul>

<h2>LAYERS Metadata domain</h2>

Starting with GDAL &gt;= 2.0.0 and when GDAL is compiled against libpoppler, the LAYERS metadata domain can be queried
to retrieve layer names that can be turned ON or OFF. This is usefull to know which values to specify for the
<i>GDAL_PDF_LAYERS</i> or i>GDAL_PDF_LAYERS_OFF</i> configuration options.<p>

For example :
<pre>
$ gdalinfo ../autotest/gdrivers/data/adobe_style_geospatial.pdf -mdd LAYERS

Driver: PDF/Geospatial PDF
Files: ../autotest/gdrivers/data/adobe_style_geospatial.pdf
[...]
Metadata (LAYERS):
  LAYER_00_NAME=New_Data_Frame
  LAYER_01_NAME=New_Data_Frame.Graticule
  LAYER_02_NAME=Layers
  LAYER_03_NAME=Layers.Measured_Grid
  LAYER_04_NAME=Layers.Graticule
[...]

$ gdal_translate ../autotest/gdrivers/data/adobe_style_geospatial.pdf out.tif --config GDAL_PDF_LAYERS_OFF "New_Data_Frame"

</pre>

<h2>Restrictions</h2>

The opening of a PDF document (to get the georeferencing) is fast, but at the first access to a raster block,
the whole page will be rasterized, which can be a slow operation.
<p>
Only a few of the possible Datums available in the OGC best practice spec have been currently mapped
in the driver. Unrecognized datums will be considered as being based on the WGS84 ellipsoid.
<p>
For documents that contain several neatlines in a page (insets), the georeferencing will be
extracted from the inset that has the largest area (in term of screen points).
<p>

<h2>Creation Issues (GDAL &gt;= 2.0.0)</h2>

<p>PDF documents can be created from other GDAL raster datasets, that
have 1 band (graylevel or with color table), 3 bands (RGB) or 4 bands (RGBA).</p>

<p>Georeferencing information will be written by default according to
the ISO32000 specification. It is also possible to write it according to the
OGC Best Practice conventions (but limited to a few datum and projection types).</p>

<h3>Creation Options</h3>

<ul>
<li><p><b>COMPRESS=[NONE/DEFLATE/JPEG/JPEG2000]</b>:
Set the compression to use. DEFLATE is the default.</p></li>

<li><p><b>DPI=value</b>:
Set the DPI to use. Default to 72.</p></li>

<li><p><b>PREDICTOR=[1/2]</b>:
Only for DEFLATE compression. Might be set to 2 to use horizontal predictor that can make files smaller (but not always!).
1 is the default.</p></li>

<li><p><b>JPEG_QUALITY=[1-100]</b>:  Set the JPEG quality when using JPEG compression.
A value of 100 is best quality (least compression), and 1 is worst quality (best compression). The default is 75.</p></li>

<li><p><b>JPEG2000_DRIVER=[JP2KAK/JP2ECW/JP2OpenJPEG/JPEG2000]</b>:
Set the JPEG2000 driver to use. If not specified, it will be searched in the previous list.</p></li>

<li><p><b>TILED=YES</b>: By default monoblock files are created.  This
option can be used to force creation of tiled PDF files.</p></li>

<li><p><b>BLOCKXSIZE=n</b>: Sets tile width, defaults to 256.</p></li>

<li><p><b>BLOCKYSIZE=n</b>: Set tile height, defaults to 256.</p></li>

<li><p><b>EXTRA_CONTENT_STREAM=content</b>: A PDF content stream to draw after the imagery, typically to add some text. It may refer
the /FTimesRoman and /FTimesBold fonts.</p></li>

<li><p><b>LAYER_NAME=name</b>: Name for layer where the raster is placed.</p></li>

<li><p><b>EXTRA_CONTENT_LAYER_NAME=name</b>: Name for layer where the extra content specified with EXTRA_CONTENT_STREAM is placed.</p></li>

<li><p><b>MARGIN/LEFT_MARGIN/RIGHT_MARGIN/TOP_MARGIN/BOTTOM_MARGIN=value</b>: Margin around image in user units.</p></li>

<li><p><b>GEO_ENCODING=[NONE/ISO32000/OGC_BP/BOTH]</b>:
Set the Geo encoding method to use. ISO32000 is the default.</p></li>

<li><p><b>NEATLINE=polygon_definition_in_wkt</b>:
Set the NEATLINE to use.</p></li>

<li><p><b>XMP=[NONE/xml_xmp_content]</b>:
By default, if the source dataset has data in the 'xml:XMP' metadata domain, this
data will be copied to the output PDF, unless this option is set to NONE. The XMP
xml string can also be directly set to this option.</p></li>

<li><p><b>WRITE_INFO=[YES/NO]</b>:
By default, the AUTHOR, CREATOR, CREATION_DATE, KEYWORDS, PRODUCER, SUBJECT and TITLE information
will be written into the PDF Info block from the corresponding metadata item from the
source dataset, or if not set, from the corresponding creation option.
If this option is set to NO, no information will be written.</p></li>

<li><p><b>AUTHOR</b>, <b>CREATOR</b>, <b>CREATION_DATE</b>, <b>KEYWORDS</b>, <b>PRODUCER</b>,
    <b>SUBJECT</b>, <b>TITLE</b> : metadata that can be written into the PDF Info block.</p></li>

</ul>

<h2>Update of existing files (GDAL &gt;= 2.0.0)</h2>

Existing PDF files (created or not with GDAL) can be opened in update mode in order to set or
update the following elements :
<ul>
    <li>Geotransform and associated projection (with SetGeoTransform() and SetProjection()) </li>
    <li>GCPs (with SetGCPs())</li>
    <li>Neatline (with SetMetadataItem("NEATLINE", polygon_definition_in_wkt))</li>
    <li>Content of Info object (with SetMetadataItem(key, value) where key is one of AUTHOR, CREATOR, CREATION_DATE, KEYWORDS, PRODUCER, SUBJECT and TITLE)</li>
    <li>xml:XMP metadata (with SetMetadata(md, "xml:XMP"))</li>
</ul>

For geotransform or GCPs, the Geo encoding method used by default is ISO32000. OGC_BP can be
selected by setting the GDAL_PDF_GEO_ENCODING configuration option to OGC_BP.<p>

Updated elements are written at the end of the file, following the incremental update method described in
the PDF specification.<p>

<h2>See also</h2>

Specifications :

<ul>
<li><a href="http://portal.opengeospatial.org/files/?artifact_id=40537">OGC GeoPDF Encoding Best Practice Version 2.2 (08-139r3)</a></li>
<li><a href="http://www.adobe.com/devnet/acrobat/pdfs/adobe_supplement_iso32000.pdf">Adobe Supplement to ISO 32000</a></li>
<li><a href="http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf">PDF Reference, version 1.7</a></li>
</ul>

<p>
Librairies :

<ul>
<li><a href="http://poppler.freedesktop.org/">Poppler homepage</a></li>
<li><a href="http://podofo.sourceforge.net/">PoDoFo homepage</a></li>
</ul>

<p>
Samples :

<ul>
<li><a href="http://acrobatusers.com/gallery/geospatial">A few Geospatial PDF samples</a></li>
<li><a href="http://www.agc.army.mil/geopdf_gallery.html">Another set of Geospatial PDF samples</a></li>
</ul>

</body>
</html>
